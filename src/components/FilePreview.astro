---
// ouch
import { readFileSync } from 'fs';

const { path } = Astro.props;

const fileName: string = path.split('/').pop() ?? '/';
const isTextFile = /\.(txt|md|html|css|js|json|bat|xml|sha256)$/i.test(path);
const isImageFile = /\.(jpg|jpeg|png|gif|webp)$/i.test(path);
---
  
<div class="file-actions">
<a href={path} class="button" download>Download</a>
<a href="/" class="button">Back to Home</a>
</div>

{isTextFile ? (
<pre>{
    readFileSync('releases/'+path).toString()}</pre>
) : isImageFile ? (
    <img src={path} alt={fileName} />
) : (
    <p>This file type cannot be previewed. Please download to view.</p>
)}

<style>
    .file-actions {
      margin: 20px 0;
      display: flex;
      gap: 10px;
    }
    .button {
      display: inline-block;
      padding: 8px 16px;
      background: #0070f3;
      color: white;
      text-decoration: none;
      border-radius: 4px;
      border: none;
      cursor: pointer;
    }
    img {
      max-width: 100%;
      height: auto;
    }
    pre { 
      background: #f5f5f5; 
      padding: 15px; 
      border-radius: 4px; 
      overflow-x: auto; 
    }
</style>