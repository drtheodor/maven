---
import { permalink } from "@/util/link";
import { readLocal, isReadable, isViewable } from "@/util/files";

const { path } = Astro.props;

const fileName: string = path.split('/').pop() ?? '/';
---
  
<div class="file-actions">
  <a href={permalink(path)} class="button" download>Download</a>
  <a href={permalink("/")} class="button">Back to Home</a>
</div>

{isReadable(path) ? (
  <pre class="raw-text">{readLocal(path)}</pre>
) : isViewable(path) ? (
  <img src={path} alt={fileName} />
) : (
  <p>This file type cannot be previewed. Please download to view.</p>
)}

<style>
  .file-actions {
    margin: 20px 0;
    display: flex;
    gap: 10px;
  }
  
  .button {
    display: inline-block;
    padding: 8px 16px;
    background: #0070f3;
    color: white;
    text-decoration: none;
    border-radius: 4px;
    border: none;
    cursor: pointer;
  }
  
  img {
    max-width: 100%;
    height: auto;
  }
</style>